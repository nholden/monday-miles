---
http_interactions:
- request:
    method: get
    uri: https://www.strava.com/api/v3/activities/122027191
    body:
      encoding: US-ASCII
      string: ''
    headers:
      Authorization:
      - Bearer invalid-token
  response:
    status:
      code: 403
      message: Forbidden
    headers:
      Date:
      - Mon, 01 Feb 2021 23:20:01 GMT
      Content-Type:
      - text/html; charset=utf-8
      Connection:
      - keep-alive
      Cache-Control:
      - no-cache
      Via:
      - 1.1 linkerd
      X-Download-Options:
      - noopen
      Status:
      - 403 Forbidden
      X-Ratelimit-Limit:
      - '600,30000'
      X-Request-Id:
      - b8d2a5d7-0a52-4b7b-a462-9ec48be8334c
      Referrer-Policy:
      - strict-origin-when-cross-origin
      X-Frame-Options:
      - DENY
      X-Ratelimit-Usage:
      - '25,2365'
      X-Content-Type-Options:
      - nosniff
      X-Permitted-Cross-Domain-Policies:
      - none
      Vary:
      - Origin
      X-Xss-Protection:
      - 1; mode=block
    body:
      encoding: ASCII-8BIT
      string: !binary |-
        PCEtLSBPcmlvbi1BcHAgTGF5b3V0IC0tPgo8IURPQ1RZUEUgaHRtbD4KPGh0bWwgY2xhc3M9J2xvZ2dlZC1vdXQgcmVzcG9uc2l2ZSBmZWVkM3AwIG9sZC1sb2dpbiBzdHJhdmEtb3Jpb24gcmVzcG9uc2l2ZScgZGlyPSdsdHInIGxhbmc9J2VuLVVTJyB4bWxuczpmYj0naHR0cDovL3d3dy5mYWNlYm9vay5jb20vMjAwOC9mYm1sJyB4bWxuczpvZz0naHR0cDovL29wZW5ncmFwaHByb3RvY29sLm9yZy9zY2hlbWEvJyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvVFIvaHRtbDUnPgo8IS0tCmxheW91dCBvcmlvbiBhcHAKLS0+CjxoZWFkPgo8bWV0YSBjaGFyc2V0PSdVVEYtOCc+CjxtZXRhIGNvbnRlbnQ9J3dpZHRoID0gZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlID0gMSwgbWF4aW11bS1zY2FsZSA9IDEnIG5hbWU9J3ZpZXdwb3J0Jz4KPHN0eWxlIHR5cGU9J3RleHQvY3NzJz4KLnNwaW5uZXIsIC5zcGlubmVyIC5zdGF0dXMgewogIHBvc2l0aW9uOiByZWxhdGl2ZTsKfQouc3Bpbm5lciB7CiAgbWFyZ2luLXRvcDogMWVtOwogIG1hcmdpbi1ib3R0b206IDFlbTsKfQouc3Bpbm5lciAuc3RhdHVzIHsKICB0b3A6IDJweDsKICBtYXJnaW4tbGVmdDogMC41ZW07Cn0KLnNwaW5uZXIgLnN0YXR1czplbXB0eSB7CiAgZGlzcGxheTogbm9uZTsKfQouc3Bpbm5lci5sZyAuZ3JhcGhpYyB7CiAgYm9yZGVyLXdpZHRoOiAzcHg7CiAgaGVpZ2h0OiAzMnB4OwogIHdpZHRoOiAzMnB4Owp9Ci5zcGlubmVyLnRpbnkgewogIGhlaWdodDogMTBweDsKICB3aWR0aDogMTBweDsKfQouc3Bpbm5lci5jZW50ZXJlZCwgLnNwaW5uZXIudmNlbnRlcmVkIHsKICBib3gtc2l6aW5nOiBib3JkZXItYm94OwogIHdpZHRoOiAxMDAlOwp9Ci5zcGlubmVyLnZjZW50ZXJlZCB7CiAgbGVmdDogMDsKICBtYXJnaW4tdG9wOiAtMTJweDsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgcmlnaHQ6IDA7CiAgdGV4dC1hbGlnbjogY2VudGVyOwogIHRvcDogNTAlOwp9Ci5zcGlubmVyIC5ncmFwaGljLCAuYWpheC1sb2FkaW5nLWltYWdlIHsKICBhbmltYXRpb246IHNwaW4gMS4ycyBpbmZpbml0ZSBsaW5lYXI7CiAgYm94LXNpemluZzogYm9yZGVyLWJveDsKICBib3JkZXItY29sb3I6ICNlZWU7CiAgYm9yZGVyLXJhZGl1czogNTAlOwogIGJvcmRlci1zdHlsZTogc29saWQ7CiAgYm9yZGVyLXRvcC1jb2xvcjogIzY2NjsKICBib3JkZXItdG9wLXN0eWxlOiBzb2xpZDsKICBib3JkZXItd2lkdGg6IDJweDsKICBjb250ZW50OiAiIjsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgaGVpZ2h0OiAyMHB4OwogIHBvc2l0aW9uOiByZWxhdGl2ZTsKICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOwogIHdpZHRoOiAyMHB4Owp9CkBrZXlmcmFtZXMgc3BpbiB7CiAgZnJvbSB7CiAgICB0cmFuc2Zvcm06IHJvdGF0ZSgwZGVnKTsKICB9CiAgdG8gewogICAgdHJhbnNmb3JtOiByb3RhdGUoMzU5ZGVnKTsKICB9Cn0KPC9zdHlsZT4KCjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgbWVkaWE9InNjcmVlbiIgaHJlZj0iaHR0cHM6Ly9kM25uODJ1YXhpanBtNi5jbG91ZGZyb250Lm5ldC9hc3NldHMvc3RyYXZhLWFwcC1pY29ucy1kZmY0YzEwNWRlN2JjNGU1MTA1NDczY2YzNzU2YzVhOTkxZWJkNWUzOWE1YmMzZWUwMTEwYWZhNmUwNDI1NjUwLmNzcyIgLz4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBtZWRpYT0ic2NyZWVuIiBocmVmPSJodHRwczovL2Qzbm44MnVheGlqcG02LmNsb3VkZnJvbnQubmV0L2Fzc2V0cy9zdHJhdmEtb3Jpb24tOWQxOGM1MGEwNzRkYzlhYzliZWEzYmQ1ZWM1NzczNzkzODg1MWU2YzUzZDkxZGE3YTZiNjUyNGMyNzc2M2ZhNy5jc3MiIC8+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgbWVkaWE9InNjcmVlbiIgaHJlZj0iaHR0cHM6Ly9kM25uODJ1YXhpanBtNi5jbG91ZGZyb250Lm5ldC9hc3NldHMvZXJyb3JzL2Jhc2UtNDJmMDZlMjFkNDQzMDQ2MWJkN2FkYTc4MjdmZDhmOTQ2ZTA1NjU3MDJkNjZlYzA2NTlkNzdkNWMxYzNkZjNmZS5jc3MiIC8+Cgo8bGluayBocmVmPSdodHRwczovL2Qzbm44MnVheGlqcG02LmNsb3VkZnJvbnQubmV0L2FwcGxlLXRvdWNoLWljb24tMTgweDE4MC5wbmc/dj1kTGxXeWRXbEc4JyByZWw9J2FwcGxlLXRvdWNoLWljb24nIHNpemVzPScxODB4MTgwJz4KPGxpbmsgaHJlZj0naHR0cHM6Ly9kM25uODJ1YXhpanBtNi5jbG91ZGZyb250Lm5ldC9hcHBsZS10b3VjaC1pY29uLTE1MngxNTIucG5nP3Y9ZExsV3lkV2xHOCcgcmVsPSdhcHBsZS10b3VjaC1pY29uJyBzaXplcz0nMTUyeDE1Mic+CjxsaW5rIGhyZWY9J2h0dHBzOi8vZDNubjgydWF4aWpwbTYuY2xvdWRmcm9udC5uZXQvYXBwbGUtdG91Y2gtaWNvbi0xNDR4MTQ0LnBuZz92PWRMbFd5ZFdsRzgnIHJlbD0nYXBwbGUtdG91Y2gtaWNvbicgc2l6ZXM9JzE0NHgxNDQnPgo8bGluayBocmVmPSdodHRwczovL2Qzbm44MnVheGlqcG02LmNsb3VkZnJvbnQubmV0L2FwcGxlLXRvdWNoLWljb24tMTIweDEyMC5wbmc/dj1kTGxXeWRXbEc4JyByZWw9J2FwcGxlLXRvdWNoLWljb24nIHNpemVzPScxMjB4MTIwJz4KPGxpbmsgaHJlZj0naHR0cHM6Ly9kM25uODJ1YXhpanBtNi5jbG91ZGZyb250Lm5ldC9hcHBsZS10b3VjaC1pY29uLTExNHgxMTQucG5nP3Y9ZExsV3lkV2xHOCcgcmVsPSdhcHBsZS10b3VjaC1pY29uJyBzaXplcz0nMTE0eDExNCc+CjxsaW5rIGhyZWY9J2h0dHBzOi8vZDNubjgydWF4aWpwbTYuY2xvdWRmcm9udC5uZXQvYXBwbGUtdG91Y2gtaWNvbi03Nng3Ni5wbmc/dj1kTGxXeWRXbEc4JyByZWw9J2FwcGxlLXRvdWNoLWljb24nIHNpemVzPSc3Nng3Nic+CjxsaW5rIGhyZWY9J2h0dHBzOi8vZDNubjgydWF4aWpwbTYuY2xvdWRmcm9udC5uZXQvYXBwbGUtdG91Y2gtaWNvbi03Mng3Mi5wbmc/dj1kTGxXeWRXbEc4JyByZWw9J2FwcGxlLXRvdWNoLWljb24nIHNpemVzPSc3Mng3Mic+CjxsaW5rIGhyZWY9J2h0dHBzOi8vZDNubjgydWF4aWpwbTYuY2xvdWRmcm9udC5uZXQvYXBwbGUtdG91Y2gtaWNvbi02MHg2MC5wbmc/dj1kTGxXeWRXbEc4JyByZWw9J2FwcGxlLXRvdWNoLWljb24nIHNpemVzPSc2MHg2MCc+CjxsaW5rIGhyZWY9J2h0dHBzOi8vZDNubjgydWF4aWpwbTYuY2xvdWRmcm9udC5uZXQvYXBwbGUtdG91Y2gtaWNvbi01N3g1Ny5wbmc/dj1kTGxXeWRXbEc4JyByZWw9J2FwcGxlLXRvdWNoLWljb24nIHNpemVzPSc1N3g1Nyc+CjxsaW5rIGhyZWY9J2h0dHBzOi8vZDNubjgydWF4aWpwbTYuY2xvdWRmcm9udC5uZXQvZmF2aWNvbi0zMngzMi5wbmc/dj1kTGxXeWRXbEc4JyByZWw9J2ljb24nIHNpemVzPSczMngzMicgdHlwZT0naW1hZ2UvcG5nJz4KPGxpbmsgaHJlZj0naHR0cHM6Ly9kM25uODJ1YXhpanBtNi5jbG91ZGZyb250Lm5ldC9pY29uLXN0cmF2YS1jaHJvbWUtMTkyLnBuZz92PWRMbFd5ZFdsRzgnIHJlbD0naWNvbicgc2l6ZXM9JzE5MngxOTInIHR5cGU9J2ltYWdlL3BuZyc+CjxsaW5rIGhyZWY9J2h0dHBzOi8vZDNubjgydWF4aWpwbTYuY2xvdWRmcm9udC5uZXQvZmF2aWNvbi05Nng5Ni5wbmc/dj1kTGxXeWRXbEc4JyByZWw9J2ljb24nIHNpemVzPSc5Nng5NicgdHlwZT0naW1hZ2UvcG5nJz4KPGxpbmsgaHJlZj0naHR0cHM6Ly9kM25uODJ1YXhpanBtNi5jbG91ZGZyb250Lm5ldC9mYXZpY29uLTE2eDE2LnBuZz92PWRMbFd5ZFdsRzgnIHJlbD0naWNvbicgc2l6ZXM9JzE2eDE2JyB0eXBlPSdpbWFnZS9wbmcnPgo8bGluayBocmVmPScvbWFuaWZlc3QuanNvbj92PWRMbFd5ZFdsRzgnIHJlbD0nbWFuaWZlc3QnPgo8bWV0YSBjb250ZW50PScjRkM1MjAwJyBuYW1lPSdtc2FwcGxpY2F0aW9uLVRpbGVDb2xvcic+CjxtZXRhIGNvbnRlbnQ9J2h0dHBzOi8vZDNubjgydWF4aWpwbTYuY2xvdWRmcm9udC5uZXQvbXN0aWxlLTE0NHgxNDQucG5nP3Y9ZExsV3lkV2xHOCcgbmFtZT0nbXNhcHBsaWNhdGlvbi1UaWxlSW1hZ2UnPgo8bWV0YSBjb250ZW50PScjRkM1MjAwJyBuYW1lPSd0aGVtZS1jb2xvcic+CjxtZXRhIGNvbnRlbnQ9J1N0cmF2YScgbmFtZT0nYXBwbGUtbW9iaWxlLXdlYi1hcHAtdGl0bGUnPgo8bWV0YSBjb250ZW50PSdTdHJhdmEnIG5hbWU9J2FwcGxpY2F0aW9uLW5hbWUnPgo8bWV0YSBjb250ZW50PSd5ZXMnIG5hbWU9J2FwcGxlLW1vYmlsZS13ZWItYXBwLWNhcGFibGUnPgo8bWV0YSBjb250ZW50PSdibGFjaycgbmFtZT0nYXBwbGUtbW9iaWxlLXdlYi1hcHAtc3RhdHVzLWJhci1zdHlsZSc+Cgo8c2NyaXB0IHR5cGU9J2FwcGxpY2F0aW9uL2xkK2pzb24nPgp7CiAgIkBjb250ZXh0IjogImh0dHA6Ly9zY2hlbWEub3JnIiwKICAiQHR5cGUiOiAiT3JnYW5pemF0aW9uIiwKICAibmFtZSI6ICJTdHJhdmEiLAogICJ1cmwiOiAiaHR0cHM6Ly93d3cuc3RyYXZhLmNvbS8iLAogICJsb2dvIjogImh0dHBzOi8vZDNubjgydWF4aWpwbTYuY2xvdWRmcm9udC5uZXQvYXNzZXRzL2JyYW5kcy9zdHJhdmEvbG9nby1zdHJhdmEtbGctNTY3MTEwNWZmZGRiODZlNDM3YmI2ODUwM2E0OTczZThiZjA3ZTJhNDFjMGIzMzJkM2UzYmNlZDIxZDUzN2U5OC5wbmciLAogICJzYW1lQXMiOiBbCiAgICAiaHR0cHM6Ly9mYWNlYm9vay5jb20vU3RyYXZhIiwKICAgICJodHRwczovL3R3aXR0ZXIuY29tL3N0cmF2YSIsCiAgICAiaHR0cHM6Ly9pbnN0YWdyYW0uY29tL3N0cmF2YSIsCiAgICAiaHR0cHM6Ly95b3V0dWJlLmNvbS9zdHJhdmFpbmMiLAogICAgImh0dHBzOi8vYmxvZy5zdHJhdmEuY29tIiwKICAgICJodHRwczovL2dpdGh1Yi5jb20vc3RyYXZhIiwKICAgICJodHRwczovL21lZGl1bS5jb20vc3RyYXZhLWVuZ2luZWVyaW5nIgogIF0KfQoKCjwvc2NyaXB0Pgo8bWV0YSBuYW1lPSJjc3JmLXBhcmFtIiBjb250ZW50PSJhdXRoZW50aWNpdHlfdG9rZW4iIC8+CjxtZXRhIG5hbWU9ImNzcmYtdG9rZW4iIGNvbnRlbnQ9IkhFNERiRmtKRTNGajNtNTBvQ1M5S1lyeUJoME9mQjhpUWpKRlYyalpCYUp5cnNEcVNHUm0waGlaS0hSZ2FwOWVlUmhVemhWUGE2SzZ2bmR5RHVSNi9BPT0iIC8+CjxzY3JpcHQgc3JjPSJodHRwczovL2Qzbm44MnVheGlqcG02LmNsb3VkZnJvbnQubmV0L3BhY2tzL2pzL2NodW5raW5nX3J1bnRpbWUtNzE3ZTE1ZjNhOWZkNWVhODI2NzIuanMiPjwvc2NyaXB0Pgo8c2NyaXB0IHNyYz0iaHR0cHM6Ly9kM25uODJ1YXhpanBtNi5jbG91ZGZyb250Lm5ldC9wYWNrcy9qcy9nbG9iYWwtM2UyOTk2NzA5YmRlYWRhZGYwZjQuY2h1bmsuanMiPjwvc2NyaXB0Pgo8c2NyaXB0IHNyYz0iaHR0cHM6Ly9kM25uODJ1YXhpanBtNi5jbG91ZGZyb250Lm5ldC9hc3NldHMvc3RyYXZhLWhlYWQtZDBmNGMxZjE0NzJiYmZkNzEwNDhkNmJiYmU1ZTNiOTA0MWVjMTMzMDM0M2FiNjdjZmMzYTYwOTliOGZlZTA5ZS5qcyI+PC9zY3JpcHQ+CgoKCgo8c2NyaXB0PgogICFmdW5jdGlvbihvcHRpb25zKXsKICAgIC8vIFRlbXBvcmFyeSBmaXggdG8gdHJ5IGFuZCB1bnN0aWNrIHF1ZXVlZCBzbm93cGxvdyBldmVudHMKICAgIHZhciBxdWV1ZVN0b3JhZ2VLZXkgPSAnc25vd3Bsb3dPdXRRdWV1ZV9zbm93cGxvd19jZl9nZXQnOwogICAgaWYgKGxvY2FsU3RvcmFnZSAmJiBsb2NhbFN0b3JhZ2VbcXVldWVTdG9yYWdlS2V5XSkgewogICAgICB0cnkgewogICAgICAgIHZhciBxdWV1ZSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0ocXVldWVTdG9yYWdlS2V5KSk7CiAgICAgICAgdmFyIGZpbHRlcmVkUXVldWUgPSBxdWV1ZS5maWx0ZXIoZnVuY3Rpb24oaSkgewogICAgICAgICAgICByZXR1cm4gaS5sZW5ndGggPCA1MDAwOwogICAgICAgIH0pOwogICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKHF1ZXVlU3RvcmFnZUtleSwgSlNPTi5zdHJpbmdpZnkoZmlsdGVyZWRRdWV1ZSkpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgIH0KICAgIH0KICAKICAgIHdpbmRvdy5TdHJhdmEgPSB3aW5kb3cuU3RyYXZhIHx8IHt9OwogICAgdmFyIF9lbmFibGVkID0gdHJ1ZTsKICAgIHZhciBfb3B0aW9ucyA9IG9wdGlvbnM7CiAgICB2YXIgX3Nub3dwbG93UmVhZHkgPSBudWxsOwogIAogICAgd2luZG93LlN0cmF2YS5FeHRlcm5hbEFuYWx5dGljcyA9IHdpbmRvdy5TdHJhdmEuRXh0ZXJuYWxBbmFseXRpY3MgfHwgKAogICAgICB7CiAgICAgICAgaXNFbmFibGVkOiBmdW5jdGlvbigpIHsKICAgICAgICAgIHJldHVybiBfZW5hYmxlZDsKICAgICAgICB9LAogICAgICAgIGlzRGVidWc6IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIF9vcHRpb25zLmRlYnVnOwogICAgICAgIH0sCiAgICAgICAgdHJhY2s6IGZ1bmN0aW9uKCkgewogICAgICAgIH0sCiAgICAgICAgdHJhY2tWMjogZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgICAgIHZhciBldmVudERhdGEgPSB7CiAgICAgICAgICAgICdjYXRlZ29yeSc6IGV2ZW50LmNhdGVnb3J5LAogICAgICAgICAgICAncGFnZSc6IGV2ZW50LnBhZ2UsCiAgICAgICAgICAgICdhY3Rpb24nOiBldmVudC5hY3Rpb24sCiAgICAgICAgICAgICdlbGVtZW50JzogZXZlbnQuZWxlbWVudCB8fCBudWxsLAogICAgICAgICAgICAncHJvcGVydGllcyc6IGV2ZW50LnByb3BlcnRpZXMgfHwge30KICAgICAgICAgIH0KICAgICAgICAgIGlmICh0aGlzLmlzRW5hYmxlZCgpKSB7CiAgICAgICAgICAgIHNub3dwbG93KCd0cmFja1NlbGZEZXNjcmliaW5nRXZlbnQnLCB7CiAgICAgICAgICAgICAgc2NoZW1hOiAnaWdsdTpjb20uc3RyYXZhL3RyYWNrL2pzb25zY2hlbWEvMS0wLTAnLAogICAgICAgICAgICAgIGRhdGE6IGV2ZW50RGF0YQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICEhY29uc29sZS50YWJsZSAmJiBjb25zb2xlLnRhYmxlKGV2ZW50RGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICB0cmFja0xpbms6IGZ1bmN0aW9uKCkgewogICAgICAgIH0sCiAgICAgICAgdHJhY2tGb3JtOiBmdW5jdGlvbigpIHsKICAgICAgICB9LAogICAgICAgIGlkZW50aWZ5VjI6IGZ1bmN0aW9uICgpIHsKICAgICAgICB9LAogICAgICAgIHBhZ2U6IGZ1bmN0aW9uKHBhZ2VQcm9wZXJ0aWVzKSB7CiAgICAgICAgICBpZih0aGlzLmlzRW5hYmxlZCgpKSB7CiAgICAgICAgICAgIHNub3dwbG93KCd0cmFja1BhZ2VWaWV3Jyk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBpZGVudGlmeTogZnVuY3Rpb24oYXRobGV0ZUlkLCBvcHRpb25zLCBldmVudE5hbWUpIHsKICAgICAgICAgIGlmICh0aGlzLmlzRW5hYmxlZCgpKSB7CiAgICAgICAgICAgIHZhciBwcm9wZXJ0aWVzID0gb3B0aW9ucyB8fCB7fQogICAgICAgICAgICBwcm9wZXJ0aWVzLmF0aGxldGVfaWQgPSBhdGhsZXRlSWQ7CiAgICAgICAgICAgIHZhciBldmVudERhdGEgPSB7CiAgICAgICAgICAgICAgJ2NhdGVnb3J5JzogJ2lkZW50aWZ5JywKICAgICAgICAgICAgICAncGFnZSc6IG51bGwsCiAgICAgICAgICAgICAgJ2FjdGlvbic6IGV2ZW50TmFtZSwKICAgICAgICAgICAgICAnZWxlbWVudCc6IG51bGwsCiAgICAgICAgICAgICAgJ3Byb3BlcnRpZXMnOiBwcm9wZXJ0aWVzCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHNub3dwbG93KCd0cmFja1NlbGZEZXNjcmliaW5nRXZlbnQnLCB7CiAgICAgICAgICAgICAgc2NoZW1hOiAnaWdsdTpjb20uc3RyYXZhL3RyYWNrL2pzb25zY2hlbWEvMS0wLTAnLAogICAgICAgICAgICAgIGRhdGE6IGV2ZW50RGF0YQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHJlc2V0OiBmdW5jdGlvbigpIHsKICAgICAgICAgIGlmKHRoaXMuaXNFbmFibGVkKCkpIHsKICAgICAgICAgICAgc25vd3Bsb3coJ3NldFVzZXJJZCcsIG51bGwpCiAgICAgICAgICAgIHZhciBzcENvb2tpZSA9IGRvY3VtZW50LmNvb2tpZS5tYXRjaCgnX3NwX2lkXFwuW2EtZjAtOV0rJykKICAgICAgICAgICAgaWYoc3BDb29raWUgIT0gbnVsbCkgewogICAgICAgICAgICAgIGRvY3VtZW50LmNvb2tpZSA9IHNwQ29va2llWzBdICsgIj0gOyBleHBpcmVzID0gVGh1LCAwMSBKYW4gMTk3MCAwMDowMDowMCBHTVQiCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHNldHVwU25vd3Bsb3c6IGZ1bmN0aW9uKGlkKSB7CiAgICAgICAgICBpZih0aGlzLmlzRW5hYmxlZCgpKSB7CiAgICAgICAgICAgIHNub3dwbG93KCJuZXdUcmFja2VyIiwgImNmIiwgImMuc3RyYXZhLmNvbSIsIHsKICAgICAgICAgICAgICBhcHBJZDogInN0cmF2YS13ZWIiLAogICAgICAgICAgICAgIHBsYXRmb3JtOiAid2ViIgogICAgICAgICAgICB9KTsKICAgICAgICAgICAgc25vd3Bsb3coJ3NldFVzZXJJZCcsIGlkKTsKICAgICAgICAgICAgc25vd3Bsb3coJ2VuYWJsZUZvcm1UcmFja2luZycpOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgZ2V0RG9tYWluVXNlcklkOiBmdW5jdGlvbigpIHsKICAgICAgICAgIHZhciBkID0galF1ZXJ5LkRlZmVycmVkKCk7CiAgICAgICAgICBpZiAodGhpcy5pc0VuYWJsZWQoKSkgewogICAgICAgICAgICBpZiAoIV9zbm93cGxvd1JlYWR5KSB7CiAgICAgICAgICAgICAgX3Nub3dwbG93UmVhZHkgPSBqUXVlcnkuRGVmZXJyZWQoKTsKICAgICAgICAgICAgICBzbm93cGxvdyhmdW5jdGlvbigpewogICAgICAgICAgICAgICAgX3Nub3dwbG93UmVhZHkucmVzb2x2ZSh0aGlzLmNmLmdldERvbWFpblVzZXJJZCgpKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBfc25vd3Bsb3dSZWFkeS5hbHdheXMoZnVuY3Rpb24oZ2V0RG9tYWluVXNlcklkKXsKICAgICAgICAgICAgICBkLnJlc29sdmUoZ2V0RG9tYWluVXNlcklkKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkLnJlamVjdChudWxsKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBkOwogICAgICAgIH0sCiAgICAgICAgbG9nOiBmdW5jdGlvbihtZXNzYWdlLCB2YWx1ZXMpIHsKICAgICAgICAgIGlmKHRoaXMuaXNEZWJ1ZygpKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKG1lc3NhZ2UsICdiYWNrZ3JvdW5kLWNvbG9yOiB5ZWxsb3c7IGNvbG9yOiBibHVlOyBmb250LXNpemU6IG1lZGl1bTsnLCB2YWx1ZXMpOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgZGVidWc6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgICAgICBfb3B0aW9ucy5kZWJ1ZyA9IHZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgKQogIH0oewogICAgaXNfbW9iaWxlOiBmYWxzZSwKICAgIG9zOiAiIiwKICAgIGRlYnVnOiBmYWxzZSwKICAgIGF0aGxldGVfaWQ6IDQ4Mzg0MzgzLAogICAgbG9jYWxlOiAiZW4tVVMiCiAgfSk7Cjwvc2NyaXB0PgoKPHNjcmlwdD4KICAhZnVuY3Rpb24oKXsKICAgIHZhciBhbmFseXRpY3MgPSB3aW5kb3cuYW5hbHl0aWNzID0gd2luZG93LmFuYWx5dGljcyB8fCBbXTsKICAgIGlmKGFuYWx5dGljcy5pbnZva2VkKSB7CiAgICAgIHdpbmRvdy5jb25zb2xlICYmIGNvbnNvbGUuZXJyb3IgJiYgY29uc29sZS5lcnJvcigiU2VnbWVudCBzbmlwcGV0IGluY2x1ZGVkIHR3aWNlLiIpOwogICAgfSBlbHNlIHsKICAgICAgKGZ1bmN0aW9uKHAsbCxvLHcsaSxuLGcpe2lmKCFwW2ldKXtwLkdsb2JhbFNub3dwbG93TmFtZXNwYWNlPXAuR2xvYmFsU25vd3Bsb3dOYW1lc3BhY2V8fFtdO3AuR2xvYmFsU25vd3Bsb3dOYW1lc3BhY2UucHVzaChpKTtwW2ldPWZ1bmN0aW9uKCl7KHBbaV0ucT1wW2ldLnF8fFtdKS5wdXNoKGFyZ3VtZW50cyl9O3BbaV0ucT1wW2ldLnF8fFtdO249bC5jcmVhdGVFbGVtZW50KG8pO2c9bC5nZXRFbGVtZW50c0J5VGFnTmFtZShvKVswXTtuLmFzeW5jPTE7bi5zcmM9dztnLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKG4sZyl9fSh3aW5kb3csZG9jdW1lbnQsInNjcmlwdCIsImh0dHBzOi8vZHk5ejQ5MTBzaHFhYy5jbG91ZGZyb250Lm5ldC8xb0c1aWNpbGQwbGFDdEpNaTQ1TGpBLmpzIiwic25vd3Bsb3ciKSk7CiAgICAgIFN0cmF2YS5FeHRlcm5hbEFuYWx5dGljcy5zZXR1cFNub3dwbG93KDQ4Mzg0MzgzKTsKICAKICAgICAgU3RyYXZhLkV4dGVybmFsQW5hbHl0aWNzLnBhZ2UobnVsbCk7CiAgICB9CiAgfSgpOwo8L3NjcmlwdD4KCjxzY3JpcHQ+CiAgIWZ1bmN0aW9uKGRlYnVnKXsKICAgIHdpbmRvdy5TdHJhdmEgPSB3aW5kb3cuU3RyYXZhIHx8IHt9OwogICAgdmFyIF9lbmFibGVkID0gZmFsc2U7CiAgICB2YXIgX2RlYnVnID0gISFkZWJ1ZzsKICAgIHZhciBfYnJhbmNoRGF0YSA9IG51bGw7CiAgCiAgICB3aW5kb3cuU3RyYXZhLkJyYW5jaElPID0gd2luZG93LlN0cmF2YS5CcmFuY2hJTyB8fCAoCiAgICAgIHsKICAgICAgICBpc0VuYWJsZWQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIF9lbmFibGVkOwogICAgICAgIH0sCiAgICAgICAgaXNEZWJ1ZzogZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gX2RlYnVnOwogICAgICAgIH0sCiAgICAgICAgZGF0YVRvTG9jYWxTdG9yYWdlOiBmdW5jdGlvbigpIHsKICAgICAgICAgIGlmICghX2JyYW5jaERhdGEpIHsKICAgICAgICAgICAgX2JyYW5jaERhdGEgPSBuZXcgU3RyYXZhLkJyYW5jaEFuYWx5dGljcy5CcmFuY2hEYXRhKCk7CiAgICAgICAgICB9CiAgCiAgICAgICAgICB2YXIgZCA9IHRoaXMuZGF0YSgpCiAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7CiAgICAgICAgICBkLmRvbmUoZnVuY3Rpb24oZGF0YSkgewogICAgICAgICAgICB0aGF0LmxvZygnc3RvcmluZyBkYXRhICVvIHRvIGxvY2FsIHN0b3JhZ2UnLCBkYXRhKQogICAgICAgICAgICBfYnJhbmNoRGF0YS5kYXRhKGRhdGEpCiAgICAgICAgICB9KTsKICAgICAgICAgIGQuZmFpbChmdW5jdGlvbihtZXNzYWdlKSB7CiAgICAgICAgICAgIHRoYXQubG9nKCdmYWlsZWQgdG8gcmV0cmlldmUgZGF0YSBmcm9tIGJyYW5jaCcpOwogICAgICAgICAgICBfYnJhbmNoRGF0YS5kYXRhKHt9KQogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gZDsKICAgICAgICB9LAogICAgICAgIGNyZWF0ZUxpbms6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgICAgICAgIHZhciBkID0galF1ZXJ5LkRlZmVycmVkKCk7CiAgICAgICAgICB2YXIgZGF0YSA9IG51bGw7CiAgICAgICAgICBjb25zdCB0aGF0ID0gdGhpczsKICAgICAgICAgIHZhciBjYWxsYmFjayA9IGZ1bmN0aW9uKGUsIGwpIHsKICAgICAgICAgICAgaWYgKCFlKSB7CiAgICAgICAgICAgICAgZC5yZXNvbHZlKGwpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGQucmVqZWN0KGUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAob3B0aW9ucy5wZWVrX2RhdGEpIHsKICAgICAgICAgICAgZGF0YSA9IHRoaXMuZGF0YUZyb21Mb2NhbFN0b3JhZ2UoKTsKICAgICAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5kYXRhX3BhcnNlZCAmJiBkYXRhLmRhdGFfcGFyc2VkWyd+cmVmZXJyaW5nX2xpbmsnXSkgewogICAgICAgICAgICAgIGQucmVzb2x2ZShkYXRhLmRhdGFfcGFyc2VkWyd+cmVmZXJyaW5nX2xpbmsnXSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgZC5yZWplY3QoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAKICAgICAgICAgICAgU3RyYXZhLkV4dGVybmFsQW5hbHl0aWNzCiAgICAgICAgICAgICAgLmdldERvbWFpblVzZXJJZCgpCiAgICAgICAgICAgICAgLmFsd2F5cyhmdW5jdGlvbihkb21haW5Vc2VySWQpewogICAgICAgICAgICAgICAgaWYgKGRvbWFpblVzZXJJZCkgewogICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGFbJ2RvbWFpblVzZXJJZCddID0gZG9tYWluVXNlcklkOwogICAgICAgICAgICAgICAgfQogIAogICAgICAgICAgICAgICAgaWYodGhhdC5pc0VuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgICBicmFuY2gubGluayhvcHRpb25zLCBjYWxsYmFjayk7CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBkOwogICAgICAgIH0sCiAgICAgICAgZGF0YUZyb21Mb2NhbFN0b3JhZ2U6IGZ1bmN0aW9uKCkgewogICAgICAgICAgaWYgKCFfYnJhbmNoRGF0YSkgewogICAgICAgICAgICBfYnJhbmNoRGF0YSA9IG5ldyBTdHJhdmEuQnJhbmNoQW5hbHl0aWNzLkJyYW5jaERhdGEoKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBfYnJhbmNoRGF0YS5kYXRhKCk7CiAgICAgICAgfSwKICAgICAgICBjbGVhckxvY2FsU3RvcmFnZTogZnVuY3Rpb24oKSB7CiAgICAgICAgICBpZiAoIV9icmFuY2hEYXRhKSB7CiAgICAgICAgICAgIF9icmFuY2hEYXRhID0gbmV3IFN0cmF2YS5CcmFuY2hBbmFseXRpY3MuQnJhbmNoRGF0YSgpOwogICAgICAgICAgfQogICAgICAgICAgX2JyYW5jaERhdGEuZGF0YSh7fSk7CiAgICAgICAgfSwKICAgICAgICBkYXRhOiBmdW5jdGlvbihjaGVja0xvY2FsU3RvcmFnZSkgewogICAgICAgICAgdmFyIGQgPSBqUXVlcnkuRGVmZXJyZWQoKTsKICAgICAgICAgIHZhciB0aGF0ID0gdGhpczsKICAgICAgICAgIHZhciBjID0gZnVuY3Rpb24obWVzc2FnZSwgbWV0YV9kYXRhKSB7CiAgICAgICAgICAgIHZhciBzdG9yZWREYXRhID0gbnVsbDsKICAKICAgICAgICAgICAgaWYobWVzc2FnZSkgewogICAgICAgICAgICAgIGQucmVqZWN0KG1lc3NhZ2UpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGlmIChjaGVja0xvY2FsU3RvcmFnZSA9PSB0cnVlICYmIChtZXRhX2RhdGEgPT0gbnVsbCB8fCBtZXRhX2RhdGEuZGF0YSA9PSAiIiB8fCBtZXRhX2RhdGEuZGF0YSA9PSBudWxsKSkgewogICAgICAgICAgICAgICAgc3RvcmVkRGF0YSA9IHRoYXQuZGF0YUZyb21Mb2NhbFN0b3JhZ2UoKTsKICAgICAgICAgICAgICAgIHRoYXQuY2xlYXJMb2NhbFN0b3JhZ2UoKTsKICAKICAgICAgICAgICAgICAgIGQucmVzb2x2ZShzdG9yZWREYXRhKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZC5yZXNvbHZlKG1ldGFfZGF0YSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9OwogIAogICAgICAgICAgaWYodGhpcy5pc0VuYWJsZWQoKSkgewogICAgICAgICAgICBicmFuY2guZGF0YShjKTsKICAgICAgICAgICAgdGhpcy5sb2coJyVjZGF0YSAoYnJhbmNoIGVuYWJsZWQpJyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLmxvZygnJWNkYXRhIChicmFuY2ggZGlzYWJsZWQpJyk7CiAgICAgICAgICAgIGQucmVzb2x2ZSh7fSk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gZDsKICAgICAgICB9LAogICAgICAgIGlkZW50aWZ5OiBmdW5jdGlvbihhdGhsZXRlSWQpIHsKICAgICAgICAgIHZhciBjYWxsYmFjayA9IGZ1bmN0aW9uKGVycm9yLCBkYXRhKSB7CiAgICAgICAgICAgIGlmIChlcnJvcikgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgaWYodGhpcy5pc0VuYWJsZWQoKSkgewogICAgICAgICAgICBicmFuY2guc2V0SWRlbnRpdHkoYXRobGV0ZUlkLCBjYWxsYmFjayk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICB0cmFjazogZnVuY3Rpb24oZXZlbnROYW1lLCBtZXRhRGF0YSkgewogICAgICAgICAgdmFyIGNhbGxiYWNrID0gZnVuY3Rpb24oZXJyb3IsIGRhdGEpIHsKICAgICAgICAgICAgaWYgKGVycm9yKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZih0aGlzLmlzRW5hYmxlZCgpKSB7CiAgICAgICAgICAgIGJyYW5jaC50cmFjayhldmVudE5hbWUsIG1ldGFEYXRhLCBjYWxsYmFjayk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBsb2c6IGZ1bmN0aW9uKG1lc3NhZ2UsIHZhbHVlcykgewogICAgICAgICAgaWYodGhpcy5pc0RlYnVnKCkpIHsKICAgICAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZSwgJ2JhY2tncm91bmQtY29sb3I6IHllbGxvdzsgY29sb3I6IGJsdWU7IGZvbnQtc2l6ZTogbWVkaXVtOycsIHZhbHVlcyk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBkZWJ1ZzogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICAgIF9kZWJ1ZyA9IHZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgKQogIH0oZmFsc2UpOwo8L3NjcmlwdD4KCgo8L2hlYWQ+Cjxib2R5PgoKPGhlYWRlciBpZD0nZ2xvYmFsLWhlYWRlcic+PCEtLQpkZXBsb3k6IDE1Njc1YjllMDViNDE0ZjhkNWEwOGQ5ZDhkOTg1OWExMTcyMDA0YTcKLS0+CjwhLS1baWYgbHRlIElFIDhdPgo8ZGl2IGNsYXNzPSdhbGVydCBhbGVydC13YXJuaW5nIG1lc3NhZ2Ugd2FybmluZyBtYi0wIHRleHQtY2VudGVyJz4KPHA+SXQgbG9va3MgbGlrZSB5b3UncmUgdXNpbmcgYSB2ZXJzaW9uIG9mIEludGVybmV0IEV4cGxvcmVyIHRoYXQgU3RyYXZhIG5vIGxvbmdlciBzdXBwb3J0cy4gUGxlYXNlIDxhIGhyZWY9J2h0dHA6Ly93d3cubWljcm9zb2Z0LmNvbS9lbi11cy9kb3dubG9hZC9pZS5hc3B4P3E9aW50ZXJuZXQrZXhwbG9yZXInPnVwZ3JhZGUgeW91ciB3ZWIgYnJvd3NlcjwvYT4gJm1kYXNoOyA8YSBocmVmPSdodHRwczovL3N0cmF2YS56ZW5kZXNrLmNvbS9lbnRyaWVzLzIwNDIwMjEyLVN1cHBvcnRlZC1Ccm93c2Vycy1vbi1TdHJhdmEnPkxlYXJuIG1vcmU8L2E+LjwvcD4KPC9kaXY+CjwhW2VuZGlmXS0tPgo8bmF2IGNsYXNzPSdjb2xsYXBzYWJsZS1uYXYgY29udGFpbmVyIG5hdi1iYXInIHJvbGU9J25hdmlnYXRpb24nPgo8ZGl2IHRpdGxlPSJSZXR1cm4gdG8gdGhlIFN0cmF2YSBob21lIHBhZ2UiIGNsYXNzPSJicmFuZGluZyI+PGEgY2xhc3M9ImJyYW5kaW5nLWNvbnRlbnQiIGhyZWY9Ii8iPjxzcGFuIGNsYXNzPSJzci1vbmx5Ij5TdHJhdmE8L3NwYW4+PC9hPjwvZGl2Pgo8IS0tIC8gTmF2IE1lbnUgQnV0dG9uIC0tPgo8YSBocmVmPSIjY29udGFpbmVyLW5hdiIgYXJpYS1leHBhbmRlZD0iZmFsc2UiIGFyaWEtY29udHJvbHM9ImNvbnRhaW5lci1uYXYiIGRhdGEtdG9nZ2xlPSJjb2xsYXBzZSIgY2xhc3M9ImJ0biBidG4tZGVmYXVsdCBidG4tbW9iaWxlLW1lbnUiIHJvbGU9ImJ1dHRvbiI+TWVudTwvYT4KPGRpdiBjbGFzcz0nY29sbGFwc2UgbmF2LWNvbnRhaW5lcicgaWQ9J2NvbnRhaW5lci1uYXYnPgo8dWwgY2xhc3M9J3VzZXItbmF2IG5hdi1ncm91cCc+CjxsaSBjbGFzcz0nbmF2LWl0ZW0nPgo8YSBjbGFzcz0ibmF2LWxpbmsiIGhyZWY9Ii9tb2JpbGUiPk1vYmlsZTwvYT4KPC9saT4KPGxpIGNsYXNzPSduYXYtaXRlbSc+CjxhIGNsYXNzPSJuYXYtbGluayIgaHJlZj0iL2ZlYXR1cmVzIj5GZWF0dXJlczwvYT4KPC9saT4KPGxpIGNsYXNzPSduYXYtaXRlbSc+CjxhIGNsYXNzPSJuYXYtbGluayIgaHJlZj0iL3ByZW1pdW0/Y3RhPXByZW1pdW0mYW1wO2VsZW1lbnQ9bmF2JmFtcDtzb3VyY2U9Z2xvYmFsLWhlYWRlciI+U3Vic2NyaXB0aW9uPC9hPgo8L2xpPgo8bGkgY2xhc3M9J25hdi1pdGVtJz4KPGEgY2xhc3M9Im5hdi1saW5rIiBocmVmPSJodHRwOi8vYmxvZy5zdHJhdmEuY29tLz91dG1fc291cmNlPXdlYnNpdGUtaGVhZGVyIj5CbG9nPC9hPgo8L2xpPgo8bGkgY2xhc3M9J25hdi1vYmplY3QtZ3JvdXAnPgo8ZGl2IGNsYXNzPSduYXYtaXRlbSBsb2dnZWRfb3V0X25hdic+CjxhIGNsYXNzPSdidG4gYnRuLXByaW1hcnkgYnRuLXNpZ251cCcgZGF0YS1zZWdpb2V2ZW50PSd7JnF1b3Q7bmFtZSZxdW90OzomcXVvdDtTaWdudXAgRmxvdyZxdW90OywmcXVvdDttZXRob2QmcXVvdDs6JnF1b3Q7d2ViJnF1b3Q7LCZxdW90O3NvdXJjZSZxdW90OzomcXVvdDtHbG9iYWwgSGVhZGVyJnF1b3Q7fScgaHJlZj0nL3JlZ2lzdGVyP2N0YT1zaWduLXVwJmFtcDtlbGVtZW50PWdsb2JhbC1oZWFkZXImYW1wO3BsYW49ZnJlZSZhbXA7c291cmNlPWFwaSUyRnYzJTJGYWN0aXZpdGllc19zaG93Jz4KU2lnbiBVcAo8L2E+CjwvZGl2Pgo8ZGl2IGNsYXNzPSduYXYtaXRlbSBsb2dnZWRfb3V0X25hdic+CjxhIGNsYXNzPSdidG4gYnRuLWRlZmF1bHQgYnRuLWxvZ2luJyBkYXRhLXNlZ2lvZXZlbnQ9J3smcXVvdDtuYW1lJnF1b3Q7OiZxdW90O0xvZ2luIEZsb3cmcXVvdDssJnF1b3Q7bWV0aG9kJnF1b3Q7OiZxdW90O3dlYiZxdW90OywmcXVvdDtzb3VyY2UmcXVvdDs6JnF1b3Q7R2xvYmFsIEhlYWRlciZxdW90O30nIGhyZWY9J2h0dHBzOi8vd3d3LnN0cmF2YS5jb20vbG9naW4/Y3RhPWxvZy1pbiZhbXA7ZWxlbWVudD1nbG9iYWwtaGVhZGVyJmFtcDtzb3VyY2U9YXBpJTJGdjMlMkZhY3Rpdml0aWVzX3Nob3cnPgpMb2cgSW4KPC9hPgo8L2Rpdj4KPC9saT4KPC91bD4KCjwvZGl2Pgo8L25hdj4KPC9oZWFkZXI+CgoKCgo8ZGl2IGNsYXNzPSdlcnJvcjR4eCBlcnJvci1wYWdlJyBpZD0nZXJyb3I0MDMnPgo8ZGl2IGNsYXNzPSdjb250YWluZXInPgo8ZGl2IGNsYXNzPSdzeXN0ZW0tcGFnZSBlcnJvci1ib2R5IHJvdyc+CjxkaXYgY2xhc3M9J2Rlc2NyaXB0aW9uIGNvbC1tZC02IGNvbC1tZC1vZmZzZXQtNic+CjxoMT5Tb3JyeSwgeW91IGRvbiYjMzk7dCBoYXZlIGFjY2VzcyB0byB0aGlzIHBhZ2UuPC9oMT4KPHA+UGxlYXNlIG1ha2Ugc3VyZSB5b3UgaGF2ZSBlbnRlcmVkIHRoZSBjb3JyZWN0IFVSTCBvciBnbyBiYWNrIHRvIDxhIGhyZWY9J2h0dHA6Ly9zdHJhdmEuY29tJz5TdHJhdmEuY29tPC9hPiB0byBrZWVwIGV4cGxvcmluZy4gVmlzaXQgdGhlIDxhIGhyZWY9J2h0dHBzOi8vc3RyYXZhLnplbmRlc2suY29tL3RpY2tldHMvbmV3Jz5TdHJhdmEgU3VwcG9ydDwvYT4gc2l0ZSBmb3IgZnVydGhlciBhc3Npc3RhbmNlLjwvcD4KPC9kaXY+CjwvZGl2Pgo8L2Rpdj4KPC9kaXY+Cgo8Zm9vdGVyIGlkPSdnbG9iYWwtZm9vdGVyJz4KPGRpdiBjbGFzcz0nY29udGFpbmVyLWZsdWlkJz4KPGRpdiBjbGFzcz0ncm93IGZvb3Rlci1uYXYgZm9vdGVyLXJvdyc+CjxkaXYgY2xhc3M9J2Zvb3Rlci1uYXYtd3JhcHBlcic+CjxkaXYgY2xhc3M9J2Zvb3Rlci1uYXYtbWVudSBjb2wtbGctMiBjb2wtbWQtMyBjb2wtc20tMyBjb2wteHMtNic+CjxoNCB0YWJpbmRleD0nMCc+Ck91ciBDb21tdW5pdHkKPC9oND4KPHVsIGNsYXNzPSdmb290ZXItbmF2LXN1Ym1lbnUgbGlzdC11bnN0eWxlZCB0ZXh0LWxlZnQnPgo8bGk+CjxhIGhyZWY9Jy9hYm91dCc+CkFib3V0CjwvYT4KPC9saT4KPGxpPgo8YSBocmVmPScvY29tbXVuaXR5LXN0YW5kYXJkcyc+ClN0cmF2YSBDb21tdW5pdHkgU3RhbmRhcmRzCjwvYT4KPC9saT4KPGxpPgo8YSBocmVmPScvY2FyZWVycyc+CkNhcmVlcnMKPC9hPgo8L2xpPgo8bGk+CjxhIGhyZWY9Jy9wcm9zJz4KUHJvcyBvbiBTdHJhdmEKPC9hPgo8L2xpPgo8L3VsPgo8L2Rpdj4KPGRpdiBjbGFzcz0nZm9vdGVyLW5hdi1tZW51IGNvbC1sZy0yIGNvbC1tZC0zIGNvbC1zbS0zIGNvbC14cy02Jz4KPGg0IHRhYmluZGV4PScwJz4KRm9sbG93CjwvaDQ+Cjx1bCBjbGFzcz0nZm9vdGVyLW5hdi1zdWJtZW51IGxpc3QtdW5zdHlsZWQgdGV4dC1sZWZ0Jz4KPGxpPgo8YSBocmVmPSdodHRwOi8vYmxvZy5zdHJhdmEuY29tLycgdGFyZ2V0PSdfYmxhbmsnPgpCbG9nCjwvYT4KPC9saT4KPGxpPgo8YSBocmVmPSdodHRwczovL3d3dy5mYWNlYm9vay5jb20vU3RyYXZhLycgdGFyZ2V0PSdfYmxhbmsnPgpGYWNlYm9vawo8L2E+CjwvbGk+CjxsaT4KPGEgaHJlZj0naHR0cHM6Ly9pbnN0YWdyYW0uY29tL3N0cmF2YScgdGFyZ2V0PSdfYmxhbmsnPgpJbnN0YWdyYW0KPC9hPgo8L2xpPgo8bGk+CjxhIGhyZWY9J2h0dHA6Ly90d2l0dGVyLmNvbS9zdHJhdmEnIHRhcmdldD0nX2JsYW5rJz4KVHdpdHRlcgo8L2E+CjwvbGk+CjwvdWw+CjwvZGl2Pgo8ZGl2IGNsYXNzPSdmb290ZXItbmF2LW1lbnUgY29sLWxnLTIgY29sLW1kLTMgY29sLXNtLTMgY29sLXhzLTYnPgo8aDQgdGFiaW5kZXg9JzAnPgpTdXBwb3J0CjwvaDQ+Cjx1bCBjbGFzcz0nZm9vdGVyLW5hdi1zdWJtZW51IGxpc3QtdW5zdHlsZWQgdGV4dC1sZWZ0Jz4KPGxpPgo8YSBocmVmPSdodHRwczovL3N0cmF2YS56ZW5kZXNrLmNvbS9lbnRyaWVzLzYxNjA4MTEwLUhvdy10by1jb250YWN0LVN0cmF2YS1TdXBwb3J0LVN1Ym1pdC1hLXRpY2tldCc+CkNvbnRhY3QKPC9hPgo8L2xpPgo8bGk+CjxhIGhyZWY9J2h0dHBzOi8vc3RyYXZhLnplbmRlc2suY29tL2VudHJpZXMvNDYzNjM4OTAtQWJvdXQtU3RyYXZhLU1hcHMnPgpDb21tdW5pdHkgRm9ydW0KPC9hPgo8L2xpPgo8bGk+CjxhIGhyZWY9J2h0dHBzOi8vc3RyYXZhLnplbmRlc2suY29tL2VudHJpZXMvNDYzNjM4OTAtQWJvdXQtU3RyYXZhLU1hcHMnPgpBYm91dCBPdXIgTWFwcwo8L2E+CjwvbGk+CjwvdWw+CjwvZGl2Pgo8ZGl2IGNsYXNzPSdjb2wtbGctMiBjb2wtbWQtMyBjb2wtc20tMyBjb2wteHMtNiBmb290ZXItbmF2LW1lbnUgdmlzaWJsZS1sZy1ibG9jayc+CjxoND4KPGEgaHJlZj0naHR0cHM6Ly9idXNpbmVzcy5zdHJhdmEuY29tJz4KQnVzaW5lc3MKPC9hPgo8L2g0Pgo8L2Rpdj4KPGRpdiBjbGFzcz0nY29sLWxnLTIgY29sLW1kLTMgY29sLXNtLTMgY29sLXhzLTYgZm9vdGVyLW5hdi1tZW51IHZpc2libGUtbGctYmxvY2snPgo8aDQ+CjxhIGhyZWY9Jy9tb2JpbGUnPgpNb2JpbGUKPC9hPgo8L2g0Pgo8L2Rpdj4KPGRpdiBjbGFzcz0nY29sLWxnLTIgY29sLW1kLTMgY29sLXNtLTMgY29sLXhzLTYgZm9vdGVyLW5hdi1tZW51IHZpc2libGUtbGctYmxvY2snPgo8aDQ+CjxhIGhyZWY9Jy9wcmVtaXVtJz4KU3Vic2NyaXB0aW9uCjwvYT4KPC9oND4KPC9kaXY+CjxkaXYgY2xhc3M9J2Zvb3Rlci1uYXYtbWVudSBjb2wtbWQtMyBjb2wtc20tMyBjb2wteHMtNiBoaWRkZW4tbGcnPgo8aDQgY2xhc3M9J21vcmUnPgo8c3BhbiBjbGFzcz0iYXBwLWljb24td3JhcHBlciAgIj48c3BhbiBjbGFzcz0iYXBwLWljb24gaWNvbi1lbGxpcHNpcyBpY29uLXhsIj5Nb3JlPC9zcGFuPjwvc3Bhbj4KPC9oND4KPHVsIGNsYXNzPSdmb290ZXItbmF2LXN1Ym1lbnUgbGlzdC11bnN0eWxlZCB0ZXh0LWxlZnQnPgo8bGk+CjxhIGhyZWY9Jy9tb2JpbGUnPgpNb2JpbGUKPC9hPgo8L2xpPgo8bGk+CjxhIGhyZWY9Jy9wcmVtaXVtJz4KU3Vic2NyaXB0aW9uCjwvYT4KPC9saT4KPGxpPgo8YSBocmVmPSdodHRwczovL2J1c2luZXNzLnN0cmF2YS5jb20nPgpCdXNpbmVzcwo8L2E+CjwvbGk+CjwvdWw+CjwvZGl2Pgo8L2Rpdj4KPC9kaXY+CjxkaXYgY2xhc3M9J3JvdyBmb290ZXItb3RoZXInPgo8ZGl2IGNsYXNzPSdjb2wtbWQtMTInPgo8ZGl2IGNsYXNzPSdwcml2YWN5LXRlcm1zJz4KPGEgaHJlZj0nL2xlZ2FsL3ByaXZhY3knPgpQcml2YWN5IFBvbGljeQo8L2E+CnwKPGEgaHJlZj0nL2xlZ2FsL3Rlcm1zJz4KVGVybXMgYW5kIENvbmRpdGlvbnMKPC9hPgo8L2Rpdj4KPGRpdiBjbGFzcz0nY29weXJpZ2h0Jz4KPHA+wqkgMjAyMSBTdHJhdmE8L3A+CjwvZGl2Pgo8L2Rpdj4KPC9kaXY+CjwvZGl2Pgo8L2Zvb3Rlcj4KCgoKPHNjcmlwdCBpZD0nbGlnaHRib3gtdGVtcGxhdGUnIHR5cGU9J3RleHQvdGVtcGxhdGUnPgo8ZGl2IGNsYXNzPSdsaWdodGJveC13aW5kb3cgbW9kYWwtY29udGVudCc+CjxkaXYgY2xhc3M9J2Nsb3NlLWxpZ2h0Ym94Jz4KPGJ1dHRvbiBjbGFzcz0nYnRuIGJ0bi11bnN0eWxlZCBidG4tY2xvc2UnPgo8ZGl2IGNsYXNzPSdhcHAtaWNvbiBpY29uLWNsb3NlIGljb24teHMgaWNvbi13aGl0ZSc+PC9kaXY+CjwvYnV0dG9uPgo8L2Rpdj4KPC9kaXY+Cjwvc2NyaXB0Pgo8c2NyaXB0IGlkPSdwb3BvdmVyLXRlbXBsYXRlJyB0eXBlPSd0ZXh0L3RlbXBsYXRlJz4KPGRpdiBjbGFzcz0ncG9wb3Zlcic+PC9kaXY+Cjwvc2NyaXB0Pgo8c2NyaXB0PgogIHdpbmRvdy5fYXNzZXRfaG9zdCA9ICJodHRwczovL2Qzbm44MnVheGlqcG02LmNsb3VkZnJvbnQubmV0IjsKICB3aW5kb3cuX21lYXN1cmVtZW50X3ByZWZlcmVuY2UgPSAibWV0ZXJzIjsKICB3aW5kb3cuX2RhdGVfcHJlZmVyZW5jZSA9ICIlbS8lZC8lWSI7CiAgd2luZG93Ll9kYXRlcGlja2VyX3ByZWZlcmVuY2VfZm9ybWF0ID0gIm1tL2RkL3l5IjsKICAKICBqUXVlcnkoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkgewogICAgU3RyYXZhLlV0aWwuRXZlbnRMb2dnaW5nLmNyZWF0ZUluc3RhbmNlKCJodHRwczovL2FuYWx5dGljcy5zdHJhdmEuY29tIiwiNzIxNWZhNjBiNWYwMWVjYzM5Njc1NDM2MTlmN2UzZDkiLCBudWxsKTsKICB9KTsKPC9zY3JpcHQ+CjxzY3JpcHQgc3JjPSJodHRwczovL2Qzbm44MnVheGlqcG02LmNsb3VkZnJvbnQubmV0L2Fzc2V0cy9zdHJhdmEvaTE4bi9sb2NhbGVzL2VuLVVTLTA0YmQ3YWIwMTYzM2I4ZWVkNjhjZDA0ZjU2ZTdiNzA2MTdlMjVlYzI5YWVlNzRjZTNmYWMzYWQ3NTdjMDJlMWYuanMiPjwvc2NyaXB0Pgo8c2NyaXB0IHNyYz0iaHR0cHM6Ly9kM25uODJ1YXhpanBtNi5jbG91ZGZyb250Lm5ldC9hc3NldHMvYXBwbGljYXRpb24tM2UzYzIyZGM1ZWUyMjVmODA3MjRhNmZmMDIwMDkwYjQxNTUzMGU2MDNmZDg0OTQ4ODM0OWE4MzFkMmNlNmRkMS5qcyI+PC9zY3JpcHQ+Cgo8c2NyaXB0IHNyYz0iaHR0cHM6Ly93d3cuc3RyYXZhLmNvbS9jb29raWUtYmFubmVyIj48L3NjcmlwdD4KPHNjcmlwdD4KICBqUXVlcnkoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCl7CiAgICB0eXBlb2YgU3RyYXZhQ29va2llQmFubmVyICE9PSAndW5kZWZpbmVkJyAmJiBTdHJhdmFDb29raWVCYW5uZXIucmVuZGVyKCk7CiAgfSk7Cjwvc2NyaXB0PgoKCjxkaXYgaWQ9J2ZiLXJvb3QnPjwvZGl2Pgo8c2NyaXB0PgogIHdpbmRvdy5mYkFzeW5jSW5pdCA9IGZ1bmN0aW9uKCkgewogICAgRkIuaW5pdCh7CiAgICAgIGFwcElkOiAiMjg0NTk3Nzg1MzA5IiwKICAgICAgc3RhdHVzOiB0cnVlLAogICAgICBjb29raWU6IHRydWUsCiAgICAgIHhmYm1sOiB0cnVlLAogICAgICB2ZXJzaW9uOiAidjMuMiIKICAgIH0pOwogICAgU3RyYXZhLkZhY2Vib29rLlBlcm1pc3Npb25zTWFuYWdlci5nZXRJbnN0YW5jZSgpLmZhY2Vib29rUmVhZHkoKTsKICAgIGpRdWVyeSgnI2ZiLXJvb3QnKS50cmlnZ2VyKCdmYWNlYm9vazppbml0Jyk7CiAgfTsKICAoZnVuY3Rpb24oZCl7CiAgICB2YXIganMsIGlkID0gJ2ZhY2Vib29rLWpzc2RrJywgcmVmID0gZC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2NyaXB0JylbMF07CiAgICBpZiAoZC5nZXRFbGVtZW50QnlJZChpZCkpIHtyZXR1cm47fQogICAganMgPSBkLmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOyBqcy5pZCA9IGlkOyBqcy5hc3luYyA9IHRydWU7CiAgICBqcy5zcmMgPSAiLy9jb25uZWN0LmZhY2Vib29rLm5ldC9lbl9VUy9zZGsuanMiOwogICAgcmVmLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGpzLCByZWYpOwogIH0oZG9jdW1lbnQpKTsKPC9zY3JpcHQ+CgoKPHNjcmlwdD4KICBqUXVlcnkoJ2RvY3VtZW50JykucmVhZHkoZnVuY3Rpb24oKSB7CiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICBqUXVlcnkoJyNmYWNlLXBpbGUnKS5jc3MoJ3Zpc2liaWxpdHknLCAndmlzaWJsZScpOwogICAgfSwgMzAwKTsKICB9KTsKICB2YXIgdWEgPSBuYXZpZ2F0b3IudXNlckFnZW50OwogIHZhciBjaGVja2VyID0gewogICAgaW9zOiB1YS5tYXRjaCgvKGlQaG9uZXxpUG9kfGlQYWQpLyksCiAgICBhbmRyb2lkOiB1YS5tYXRjaCgvQW5kcm9pZC8pCiAgfTsKICAKICB2YXIgcmVnQnV0dG9uID0galF1ZXJ5KCcjZ2V0LXN0YXJ0ZWQtYnV0dG9uJyk7CiAgaWYgKGNoZWNrZXIuYW5kcm9pZCB8fCBjaGVja2VyLmlvcykgewogICAgcmVnVXJsID0gcmVnQnV0dG9uLmF0dHIoJ2hyZWYnKTsKICAgIGlmIChjaGVja2VyLmFuZHJvaWQpIHsKICAgICAgcmVnVXJsID0gJ2h0dHBzOi8vbWFya2V0LmFuZHJvaWQuY29tL2RldGFpbHM/aWQ9Y29tLnN0cmF2YSc7CiAgICB9IGVsc2UgaWYgKGNoZWNrZXIuaW9zKSB7CiAgICAgIHJlZ1VybCA9ICdodHRwOi8vaXR1bmVzLmFwcGxlLmNvbS9hcHAvc3RyYXZhLWN5Y2xpbmcvaWQ0MjY4MjYzMDknOwogICAgfQogICAgcmVnQnV0dG9uLmF0dHIoJ2hyZWYnLCByZWdVcmwpLnRleHQoJ0dldCB0aGUgQXBwJyk7CiAgfQogIHJlZ0J1dHRvbi5jc3MoJ3Zpc2liaWxpdHknLCAndmlzaWJsZScpOwo8L3NjcmlwdD4KPHNjcmlwdD4KICB2YXIgY3VycmVudEF0aGxldGUgPSBuZXcgU3RyYXZhLk1vZGVscy5DdXJyZW50QXRobGV0ZSh7ImxvZ2dlZF9pbiI6ZmFsc2V9KTsKICBIQU1MLmdsb2JhbHMgPSBmdW5jdGlvbigpIHsKICAgIHJldHVybiB7CiAgICAgIGN1cnJlbnRBdGhsZXRlOiBjdXJyZW50QXRobGV0ZSwKICAgICAgcmVuZGVyUGFydGlhbDogZnVuY3Rpb24obmFtZSwgY29udGV4dCkgewogICAgICAgIGlmIChjb250ZXh0ID09IG51bGwpIHsKICAgICAgICAgIGNvbnRleHQgPSB0aGlzOwogICAgICAgIH0KICAgICAgICByZXR1cm4gSlNUW25hbWVdKGNvbnRleHQpOwogICAgICB9CiAgICB9CiAgfQo8L3NjcmlwdD4KCjxzY3JpcHQ+CiAgbmV3IFN0cmF2YS5Jbml0aWFsaXplcigpOwo8L3NjcmlwdD4KPHNjcmlwdD4KICBpZiAoJ3NlcnZpY2VXb3JrZXInIGluIG5hdmlnYXRvcikgewogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbigpIHsKICAgICAgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIucmVnaXN0ZXIoIi9zZXJ2aWNlX3dvcmtlci5qcz92PWRMbFd5ZFdsRzgiKS50aGVuKGZ1bmN0aW9uKHJlZ2lzdHJhdGlvbikgewogICAgICB9LCBmdW5jdGlvbihlcnIpIHsKICAgICAgICBjb25zb2xlLmxvZygnU2VydmljZVdvcmtlciByZWdpc3RyYXRpb24gZmFpbGVkOiAnLCBlcnIpOwogICAgICB9KTsKICAgIH0pOwogIH0KPC9zY3JpcHQ+CjxzY3JpcHQ+CiAgalF1ZXJ5KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHsKICAgIC8vIFNjcm9sbCBUcmFja2luZwogICAgalF1ZXJ5KGRvY3VtZW50KS5vbmUoJ3Njcm9sbCcsIGZ1bmN0aW9uKCl7CiAgICAgIFN0cmF2YS5FeHRlcm5hbEFuYWx5dGljcy50cmFja1YyKHsKICAgICAgICBjYXRlZ29yeTogJ3BhZ2Vfc2Nyb2xsZWQnCiAgICAgIH0pOwogICAgfSk7CiAgfSk7Cjwvc2NyaXB0Pgo8c2NyaXB0PgogIC8vIE1vYmlsZSBNZW51IHRyYW5zaXRpb24gaGFuZGxlcgogIGpRdWVyeSgnLmNvbGxhcHNhYmxlLW5hdiAjY29udGFpbmVyLW5hdicpCiAgICAub24oJ3Nob3cuYnMuY29sbGFwc2UnLCBmdW5jdGlvbigpewogICAgICBqUXVlcnkoJy5zbWFydGJhbm5lci1jb250ZW50Jykuc2xpZGVVcCgxMDApOwogICAgICBqUXVlcnkoJ2h0bWwnKS5hZGRDbGFzcygnbW9iaWxlLW1lbnUtb3BlbicpOwogICAgfSkKICAgIC5vbignaGlkZGVuLmJzLmNvbGxhcHNlJywgZnVuY3Rpb24oKXsKICAgICAgalF1ZXJ5KCcuc21hcnRiYW5uZXItY29udGVudCcpLnNsaWRlRG93bigxMDApOwogICAgICBqUXVlcnkoJ2h0bWwnKS5yZW1vdmVDbGFzcygnbW9iaWxlLW1lbnUtb3BlbicpOwogICAgfSk7Cjwvc2NyaXB0PgoKPHNjcmlwdCBzcmM9Imh0dHBzOi8vZDNubjgydWF4aWpwbTYuY2xvdWRmcm9udC5uZXQvYXNzZXRzL2Jvb3RzdHJhcC5taW4tNTU0ODNjYTA5MzA3MDI0NGUyNDczMDE5MGI3MDdhMTg0NjdjYjc4ZDMyNjJhMDEzM2QzNGI4MGZjODJjODYzNi5qcyI+PC9zY3JpcHQ+Cgo8L2JvZHk+CjwvaHRtbD4K
    http_version:
  recorded_at: Thu, 25 Oct 2018 01:00:00 GMT
recorded_with: VCR 3.0.3
